<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Tool thay thế văn bản</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    $(document).ready(function() {
          $('#result').val('^⁠_⁠_⁠_⁠_⁠_⁠_⁠_⁠_⁠_⁠^');
      // Function to perform find and replace
      function findAndReplace(keywordData) {
        var paragraph = $('#paragraph').val();

        // Check if the textarea input is valid
        if (paragraph.trim() === '') {
          $("#er").text("Vui lòng nhập nội dung.");
          return;
        }

        // Iterate over each keyword in the JSON data
        $.each(keywordData, function(keyword, replacement) {

          var regex = new RegExp('\\b' + keyword + '\\b', 'gi');
          paragraph = paragraph.replace(regex, function(match) {
            // Preserve the case of the replaced word
            if (match === match.toUpperCase()) {
              return replacement.toUpperCase();
            } else if (match === match.toLowerCase()) {
              return replacement.toLowerCase();
            } else if (match[0] === match[0].toUpperCase()) {
              return replacement.charAt(0).toUpperCase() + replacement.slice(1);
            } else {
              return replacement;
            }
          });
        });

        // Update the paragraph with the replaced text
        $("#er").text("");
        $("#su").text("Thay thế thành công!");

        $('#result').val(paragraph);
      }

      // Event listener for find and replace button click
      $('#replaceButton').click(function() {
        // Fetch keyword data from JSON file using AJAX
        $.getJSON('data.json', function(keywordData) {
          findAndReplace(keywordData);
        });
      });

      function copyToClipboard(text) {
        var sampleTextarea = document.createElement("textarea");
        document.body.appendChild(sampleTextarea);
        sampleTextarea.value = text; // Save main text in it
        sampleTextarea.select(); // Select textarea contents
        document.execCommand("copy");
        document.body.removeChild(sampleTextarea);
      };

      $('#copy').click(function(){
        var copyText = $("#result").val();
        copyToClipboard(copyText);
      });
      
      $('#del').click(function(){
       $('#paragraph').val('')
        });
      
    });
  </script>
</head>
<body class="bg-light">
  <div class="p-2">
    <h2 class="h2 p-3 mx-auto text-center">TOOL THAY THẾ VĂN BẢN</h2>
    
    <p class="text-center text-danger">Code đang trong thử nghiệm. Có thể xảy ra lỗi<p>
    <div class="form-floating">
      <textarea class="form-control" placeholder="Nhập văn bản ở đây..." id="paragraph" style="height: 200px" required></textarea>
      <label for="floatingTextarea">Nội dung văn bản</label>
    </div>
    <br>
    <button class="btn btn-primary" id="replaceButton">Thay thế văn bản</button>
    <button class="btn btn-danger" id="del">Xoá bỏ</button>
    
    <br><br>
    <b id="er" class="text-danger"></b>
    <b id="su" class="text-success"></b>

    <div class="form-floating mt-3 rounce">
      <textarea class="form-control" id="result" placeholder="Kết quả ở đây..." style="height: 200px"></textarea>
      <label for="floatingTextarea">Kết quả</label>
    </div>
    <button class="mt-3 btn btn-success" id="copy">Sao chép nội dung</button>
  </div>
  
  
  <div class="mt-3 p-5 text-center">
    <span class="">Code write by AI</span> <br>
   <span>^⁠_⁠_⁠_⁠_⁠_⁠_⁠_⁠_⁠_⁠^</span>
    
  </div>
</body>
</html>